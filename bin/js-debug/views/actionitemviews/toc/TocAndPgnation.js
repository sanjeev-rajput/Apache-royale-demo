/**
 * Generated by Apache Royale Compiler from views/actionitemviews/toc/TocAndPgnation.as
 * views.actionitemviews.toc.TocAndPgnation
 *
 * @fileoverview
 *
 * @suppress {missingRequire|checkTypes|accessControls}
 */

goog.provide('views.actionitemviews.toc.TocAndPgnation');
/* Royale Dependency List: com.comp.pagination.Pagination,com.event.DsEvent,com.model.ServiceLoader,com.unhurdle.spectrum.Accordion,com.unhurdle.spectrum.AccordionContent,com.unhurdle.spectrum.AccordionSection,com.unhurdle.spectrum.Switch,com.util.DsUtil,org.apache.royale.collections.ArrayList,org.apache.royale.core.IBead,org.apache.royale.events.MouseEvent,org.apache.royale.jewel.Container,org.apache.royale.jewel.HGroup,org.apache.royale.jewel.supportClasses.scrollbar.ScrollingViewport,views.ContentLoaderIframe,views.actionitemviews.toc.tableData,org.apache.royale.utils.Language,XML*/




/**
 * @constructor
 * @param {org.apache.royale.jewel.Container} ctr
 * @param {org.apache.royale.jewel.HGroup} pgCtr
 */
views.actionitemviews.toc.TocAndPgnation = function(ctr, pgCtr) {
  this.views_actionitemviews_toc_TocAndPgnation_vg = ctr;
  this.views_actionitemviews_toc_TocAndPgnation_pgNationCtr = pgCtr;
};


/**
 * @private
 * @type {com.unhurdle.spectrum.Accordion}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_accUi = null;


/**
 * @private
 * @type {number}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_pgNationSelectedPage = 0;


/**
 * @private
 * @type {com.comp.pagination.Pagination}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_pgNation = null;


/**
 * @private
 * @const
 * @type {string}
 */
views.actionitemviews.toc.TocAndPgnation.EDIT = 'Edit';


/**
 * @private
 * @const
 * @type {string}
 */
views.actionitemviews.toc.TocAndPgnation.MOVE = 'Move';


/**
 * @private
 * @type {org.apache.royale.jewel.Container}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_vg = null;


/**
 * @private
 * @type {org.apache.royale.jewel.HGroup}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_pgNationCtr = null;


/**
 * @private
 * @type {string}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_addx = null;


/**
 * @private
 * @type {Object}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_pgToolEventObj = null;


/**
 * @private
 * @type {boolean}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation__isEditModeOn = false;


/**
 * @private
 * @type {boolean}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation__isMoveModeOn = false;


/**
 * @private
 * @type {Array}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation__tocDataSet = null;


/**
 * @param {Object} obj
 */
views.actionitemviews.toc.TocAndPgnation.prototype.loadAndUpdateAccData = function(obj) {
  this.views_actionitemviews_toc_TocAndPgnation_addx = org.apache.royale.utils.Language.string(obj["data"]["addx"]);
  var /** @type {com.model.ServiceLoader} */ sldr = new com.model.ServiceLoader();
  sldr.loadJData("config/" + obj["data"]["url"], org.apache.royale.utils.Language.closure(this.views_actionitemviews_toc_TocAndPgnation_dataLoadedHandler, this, 'views_actionitemviews_toc_TocAndPgnation_dataLoadedHandler'), com.model.ServiceLoader.DATA_TYPE_TEXT);
};


/**
 * @private
 * @param {Object} e
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_dataLoadedHandler = function(e) {
  console.log("toc data loaded");
  this.views_actionitemviews_toc_TocAndPgnation_parseDataToPegination(com.util.DsUtil.csvFileToJsonObj(e));
};


/**
 * @private
 * @param {Array} data
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_parseDataToPegination = function(data) {
  var self = this;
  console.log("toc data parsed");
  this.views_actionitemviews_toc_TocAndPgnation__tocDataSet = data;
  var /** @type {org.apache.royale.collections.ArrayList} */ arrList = new org.apache.royale.collections.ArrayList();
  var /** @type {string} */ subjName = "";
  var /** @type {Array} */ arr = null;
  for (var /** @type {number} */ i = 0; i <= data.length - 1; i++) {
    var /** @type {string} */ sName = org.apache.royale.utils.Language.string(data[i]["Grade"]);
    if (sName != subjName) {
      if (arr)
        arrList.addItem(arr);
      arr = new Array();
      subjName = sName;
    }
    arr.push(data[i]);
  }
  this.views_actionitemviews_toc_TocAndPgnation_pgNationSelectedPage = 0;
  this.views_actionitemviews_toc_TocAndPgnation_pgNation = null;
  if (this.views_actionitemviews_toc_TocAndPgnation_addx == 'showpgtools')
    this.views_actionitemviews_toc_TocAndPgnation_addPeginationTool(views.actionitemviews.toc.TocAndPgnation.MOVE);
  this.views_actionitemviews_toc_TocAndPgnation_pgNation = new com.comp.pagination.Pagination();
  this.views_actionitemviews_toc_TocAndPgnation_pgNationCtr.addElement(this.views_actionitemviews_toc_TocAndPgnation_pgNation);
  if (this.views_actionitemviews_toc_TocAndPgnation_addx == 'showpgtools')
    this.views_actionitemviews_toc_TocAndPgnation_addPeginationTool(views.actionitemviews.toc.TocAndPgnation.EDIT);
  this.views_actionitemviews_toc_TocAndPgnation_pgNation.addEventListener(com.comp.pagination.Pagination.PAGINATION_CHANGE_EVENT, function() {
    if (self.views_actionitemviews_toc_TocAndPgnation_pgNationSelectedPage == self.views_actionitemviews_toc_TocAndPgnation_pgNation.getCurrentPage()) {
      return;
    }
    self.views_actionitemviews_toc_TocAndPgnation_pgNationSelectedPage = self.views_actionitemviews_toc_TocAndPgnation_pgNation.getCurrentPage();
    self.views_actionitemviews_toc_TocAndPgnation_renderAccUi(arrList.getItemAt((self.views_actionitemviews_toc_TocAndPgnation_pgNation.getCurrentPage() - 1) >> 0));
  });
  this.views_actionitemviews_toc_TocAndPgnation_pgNation.setTotalPages(arrList.length);
  this.views_actionitemviews_toc_TocAndPgnation_pgNation.setCurrentPage(1);
};


/**
 * @private
 * @param {Array} data
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_renderAccUi = function(data) {
  if (this.views_actionitemviews_toc_TocAndPgnation_accUi != null)
    this.views_actionitemviews_toc_TocAndPgnation_vg.removeElement(this.views_actionitemviews_toc_TocAndPgnation_accUi);
  this.views_actionitemviews_toc_TocAndPgnation_accUi = new com.unhurdle.spectrum.Accordion();
  this.views_actionitemviews_toc_TocAndPgnation_accUi.percentWidth = 100;
  this.views_actionitemviews_toc_TocAndPgnation_accUi.height = window.innerHeight - 100;
  var /** @type {org.apache.royale.jewel.supportClasses.scrollbar.ScrollingViewport} */ bd = new org.apache.royale.jewel.supportClasses.scrollbar.ScrollingViewport();
  this.views_actionitemviews_toc_TocAndPgnation_accUi.addBead(bd);
  var /** @type {string} */ subjName = "";
  var /** @type {com.unhurdle.spectrum.AccordionSection} */ accSection = null;
  for (var /** @type {number} */ i = 0; i <= data.length - 1; i++) {
    var /** @type {string} */ sName = org.apache.royale.utils.Language.string(data[i]["Grade"]);
    if (sName != subjName) {
      if (accSection)
        this.views_actionitemviews_toc_TocAndPgnation_accUi.addElement(accSection);
      accSection = new com.unhurdle.spectrum.AccordionSection();
      accSection.headerText.big();
      accSection.headerText = sName;
      subjName = sName;
    }
    var /** @type {com.unhurdle.spectrum.AccordionContent} */ content = new com.unhurdle.spectrum.AccordionContent();
    content.className = "accItem tocText";
    content.height = 50;
    var /** @type {views.actionitemviews.toc.tableData} */ tb = new views.actionitemviews.toc.tableData();
    var /** @type {Object} */ objModel = new Object();
    objModel["dataSet"] = data[i];
    objModel["isEditModeOn"] = this.views_actionitemviews_toc_TocAndPgnation__isEditModeOn;
    objModel["isMoveModeOn"] = this.views_actionitemviews_toc_TocAndPgnation__isMoveModeOn;
    objModel["callBack"] = org.apache.royale.utils.Language.closure(this.views_actionitemviews_toc_TocAndPgnation_tbDataCallBack, this, 'views_actionitemviews_toc_TocAndPgnation_tbDataCallBack');
    tb.model = objModel;
    content.addElement(tb);
    accSection.addElement(content);
  }
  this.views_actionitemviews_toc_TocAndPgnation_accUi.addElement(accSection);
  this.views_actionitemviews_toc_TocAndPgnation_vg.addElement(this.views_actionitemviews_toc_TocAndPgnation_accUi);
  accSection.open = true;
  accSection.disabled = true;
};


/**
 * @private
 * @param {Object} item
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_tbDataCallBack = function(item) {
  var /** @type {number} */ idx = (this.views_actionitemviews_toc_TocAndPgnation__tocDataSet.indexOf(item)) >> 0;
  org.apache.royale.utils.Language.trace('id from callback' + idx);
};


/**
 * @private
 * @param {org.apache.royale.events.MouseEvent} e
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_tocItemClickHanler = function(e) {
  var /** @type {views.actionitemviews.toc.tableData} */ accContent = e.currentTarget;
  views.ContentLoaderIframe.instance.loadPage(accContent.model['url']);
  e.preventDefault();
};


/**
 * @private
 * @param {string} t
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_addPeginationTool = function(t) {
  var /** @type {com.unhurdle.spectrum.Switch} */ sw = new com.unhurdle.spectrum.Switch();
  sw.onLabel = t + " on";
  sw.offLabel = t + " off";
  sw.addEventListener(org.apache.royale.events.MouseEvent.CLICK, org.apache.royale.utils.Language.closure(this.views_actionitemviews_toc_TocAndPgnation_ptoolEventHandler, this, 'views_actionitemviews_toc_TocAndPgnation_ptoolEventHandler'));
  this.views_actionitemviews_toc_TocAndPgnation_pgNationCtr.addElement(sw);
};


/**
 * @private
 * @param {org.apache.royale.events.MouseEvent} e
 */
views.actionitemviews.toc.TocAndPgnation.prototype.views_actionitemviews_toc_TocAndPgnation_ptoolEventHandler = function(e) {
  var /** @type {boolean} */ isChecked = e.target.checked;
  var /** @type {string} */ label = org.apache.royale.utils.Language.string(e.target.onLabel.split(' ')[0]);
  if (label == views.actionitemviews.toc.TocAndPgnation.EDIT)
    this.views_actionitemviews_toc_TocAndPgnation__isEditModeOn = isChecked;
  if (label == views.actionitemviews.toc.TocAndPgnation.MOVE)
    this.views_actionitemviews_toc_TocAndPgnation__isMoveModeOn = isChecked;
  var /** @type {Object} */ obj = new Object();
  obj["isChecked"] = isChecked;
  obj["label"] = label;
  com.event.DsEvent.instance.dispatch(com.event.DsEvent.TOC_DATA_TABLE_EVENT, obj);
};


/**
 * Metadata
 *
 * @type {Object.<string, Array.<Object>>}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.ROYALE_CLASS_INFO = { names: [{ name: 'TocAndPgnation', qName: 'views.actionitemviews.toc.TocAndPgnation', kind: 'class' }] };



/**
 * Reflection
 *
 * @return {Object.<string, Function>}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.ROYALE_REFLECTION_INFO = function () {
  return {
    methods: function () {
      return {
        'TocAndPgnation': { type: 'void', declaredBy: 'views.actionitemviews.toc.TocAndPgnation', parameters: function () { return [ 'org.apache.royale.jewel.Container', false ,'org.apache.royale.jewel.HGroup', false ]; }},
        'loadAndUpdateAccData': { type: 'void', declaredBy: 'views.actionitemviews.toc.TocAndPgnation', parameters: function () { return [ 'Object', false ]; }}
      };
    }
  };
};
/**
 * @const
 * @type {number}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.ROYALE_COMPILE_FLAGS = 9;
/**
 * Provide reflection support for distinguishing dynamic fields on class object (static)
 * @const
 * @type {Array<string>}
 */
views.actionitemviews.toc.TocAndPgnation.prototype.ROYALE_INITIAL_STATICS = Object.keys(views.actionitemviews.toc.TocAndPgnation);

//# sourceMappingURL=./TocAndPgnation.js.map
