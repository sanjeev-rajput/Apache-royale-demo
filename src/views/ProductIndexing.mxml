<j:ResponsiveView xmlns="library://ns.apache.org/royale/html"
        xmlns:html="library://ns.apache.org/royale/html"
        xmlns:fx="http://ns.adobe.com/mxml/2009"
        xmlns:sp="library://ns.unhurdle.com/spectrum" 
        xmlns:js="library://ns.apache.org/royale/basic" 
        xmlns:j="library://ns.apache.org/royale/jewel" 
        xmlns:views="views.*" xmlns:actionitemviews="views.actionitemviews.*" 
        xmlns:drawing="com.comp.drawing.*"
        initComplete="initComplete()">

    <fx:Script>
        <![CDATA[
            
            import com.unhurdle.spectrum.Toast;
            import com.event.DsEvent;
            import views.actionitemviews.BasicDrawing;
            import views.actionitemviews.SearchListPopup;
            import views.actionitemviews.toc.TocAndPgnation;
            import views.actionitemviews.ai.ChatBot_MistralMedium3;
            import org.apache.royale.jewel.View;
            import org.apache.royale.jewel.Group;
            import views.actionitemviews.keybordgame.KeyGame;
                        
            private function initComplete():void {
                var t:Toast = new Toast();
                t.flavor = Toast.SUCCESS;
                t.text = "Data Loaded";
                t.autoClose=2000;
                t.show();
                //initTreeUi();
                DsEvent.instance.addEventListener(DsEvent.IFRAMECLOSED, ifameEventHandler);
                DsEvent.instance.addEventListener(DsEvent.IFRAMEOPENED, ifameEventHandler);
                DsEvent.instance.addEventListener(DsEvent.FETCH_DATA_EVENT, fetchDataEventHandler);
                DsEvent.instance.addEventListener(DsEvent.CLEAR_UI_EVENT, clearUi);
                DsEvent.instance.addEventListener(DsEvent.UI_COMPONENT_EVENT, addUiComponent);

            }

            private function ifameEventHandler(obj:Object):void {
                if(obj.type == DsEvent.IFRAMEOPENED){
                    footerUi.visible = false;
                }
                if(obj.type == DsEvent.IFRAMECLOSED){
                    footerUi.visible = true;
                }
            }

            private function fetchDataEventHandler(obj:Object):void {
                    clearUi();
                    var tocPg:TocAndPgnation = new TocAndPgnation(vg, pgNationCtr);
                    tocPg.loadAndUpdateAccData(obj);
                    title.text = obj.data.title;
            }

            private function addUiComponent(obj:Object):void{
                clearUi();
                //var drawingComp:DrawingCanvasComponent = new DrawingCanvasComponent();
                var compName:String = obj.data.title;
                var uiComp:Group;
                if(compName == 'Basic Drawing'){
                    uiComp = new BasicDrawing();
                    vg.addElement(uiComp);
                    return;
                }
                if(compName == 'AI - Chatbot - mistral-medium-3'){
                    uiComp = new ChatBot_MistralMedium3();
                    vg.addElement(uiComp);
                    return;
                }
                if(compName == 'Game'){
                    uiComp = new KeyGame() as Group;
                    vg.addElement(uiComp);
                    uiComp.x = (vg.width - uiComp.width)/2
                    return;
                }
                if(compName == 'Load & Filter Data'){
                    var sLstComp:SearchListPopup = new SearchListPopup();
                    sLstComp.showCloseBtn = false;
                    vg.addElement(sLstComp);
                    return;
                }
                
            }

            private function clearUi():void{
                while(vg.numElements>0){
                    vg.removeElement(vg.getElementAt(0));
                }
                while (pgNationCtr.numElements > 0) {
                    pgNationCtr.removeElement(pgNationCtr.getElementAt(0));
                }
                title.text = "Make an action using 'L' and 'R' menu";

            }
            

        ]]>
    </fx:Script>
        <j:VGroup percentWidth="100" itemsVerticalAlign="itemsCenter" itemsHorizontalAlign="itemsCenter">
        <j:HGroup percentWidth="100" className="actionHgroup"
        itemsVerticalAlign="itemsCenter" itemsHorizontalAlign="itemsSpaceAround">
            <views:TopMenuL />
            <j:Label id="title" text="Make an action using 'L' and 'R' menu"/>
            <views:TopMenuR />
        </j:HGroup>
            <j:FooterBar percentWidth="100" x="0" localId="footerUi" className="footerBarText">
                <j:HGroup localId="pgNationCtr" itemsHorizontalAlign="itemsSpaceAround" itemsVerticalAlign="itemsCenter" 
                className="paginatiocontainer"/>
                <sp:Label x="0" percentWidth="100" text="Copyright Â© 2022 - 2024 All rights reserved. " />
            </j:FooterBar>
        <j:Container localId="vg" percentWidth="100" percentHeight="100">
        <!-- <actionitemviews:Socket/> -->
        </j:Container>
        </j:VGroup>
</j:ResponsiveView>